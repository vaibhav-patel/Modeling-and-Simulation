close all;
clear all;
k = 0.--8;
b = 0.5;
p=0.25;
q=0.1;
rr=0.8;
ir=0.2;
u=0.2;
dr=0.02;
total = 14;
dt = 0.1;
iter = total / dt + 1;
t = zeros(iter, 1);
S = zeros(iter, 1);
Sq = zeros(iter, 1);
I = zeros(iter, 1);
Iq = zeros(iter, 1);
E = zeros(iter, 1);
Eq = zeros(iter, 1);
Id = zeros(iter, 1);
R = zeros(iter, 1);
D = zeros(iter, 1);
S(1) = 9000;
I(1) = 1000;
N=S(1)+I(1);
for i = 2 : iter
    S(i)= S(i-1) + dt*(     (((-1)*k*b*I(i-1)*S(i-1))/(N))  +   (((-1)*q*k*(1-b)*I(i-1)*S(i-1))/(N)) +  u*Sq(i-1) );
    Sq(i)= Sq(i-1) + dt*(     ((q*k*(1-b)*I(i-1)*S(i-1))/(N))  +  (-1)*u*Sq(i-1) );
    I(i)= I(i-1) + dt*( p*E(i-1)  - ir*(I(i-1)) - dr*I(i-1)  - rr*I(i-1) );
    Iq(i)= Iq(i-1) + dt*( p*Eq(i-1)  - ir*(Iq(i-1)) - dr*Iq(i-1)  - rr*Iq(i-1) );
    Id(i)= Id(i-1) + dt*(rr*(I(i-1) + Iq(i-1))  -  dr*(Id(i-1)) -rr*(Id(i-1))  );
    D(i) = D(i-1)  +dt*(dr*(Iq(i-1) + I(i-1) +Id(i-1)));
    R(i)=R(i)+dt*(rr*( I(i-1)+Iq(i-1)+Id(i-1)));
    E(i)= E(i-1) + dt*(     (1-q)*((k*b*I(i-1)*S(i-1))/(N))   -p*E(i-1) );
    Eq(i)= Eq(i-1) + dt*(     (q)*((k*b*I(i-1)*S(i-1))/(N))   -p*Eq(i-1) );
    t(i) = t(i - 1) + dt;
end;
plot(t, S,'linewidth',1.2);
hold on;
plot(t, I,'linewidth',1.2);
hold on;
plot(t, R,'linewidth',1.2);
